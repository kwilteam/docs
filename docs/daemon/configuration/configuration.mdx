---
sidebar_position: 1
sidebar_label: "Configuration"
id: daemon-config
title: Configuration
description: Configuration specification
slug: /daemon/config
---

This section outlines the complete set of configurations available for the operation of a Kwil node. These configurations are categorized into three distinct types: chain-specific configurations that pertain to the underlying blockchain functionality, app-specific configurations that govern the behavior of kwild application, and logging. 

Lets take a look into the different sections of the config. 

## logging

- `level`: This variable sets the logging level of the daemon. The default level is `info`.

- `output_paths`: This variable sets the output paths for logs. Multiple paths can be specified, separated by commas. By default, logs are written to `stdout`.

- `format`: This variable sets the logging format. Supports `plain` or `json`.

- `time_format`: This variables sets the time format for logs. Available options are `epochfloat` (default), `epochmilli`, or `rfc3339milli`.

## app   
This section contains configuration specific to the operation of kwild application.

- `grpc_listen_addr`: This variable sets the address at which the gRPC server of the daemon listens for connections. The default value is `localhost:50051`.

- `http_listen_addr`: This variable sets the address at which the HTTP server of the daemon listens for connections. The default value is `localhost:8080`.

- `sqlite_file_path`: This variable sets the file path for all SQLite files. If not provided, it defaults to `data/kwil.db/` under the specified root_dir.

- `extension_endpoints`: This variable defines endpoints for extensions. Multiple endpoints can be specified, separated by commas.

- `tls_cert_file`: This variable sets the path to a file containing certificate that is used to enable TLS on the gRPC server. The path can be either an absolute path or path relative to the configured root_dir. If not provided, only http server would be created. 

- `tls_key_file`: This variable sets the path to a file containing matching private key that is used to enable TLS on the gRPC server. The path can be either an absolute path or path relative to the configured root_dir. If not provided, only http server would be created.

- `hostname`: This variable sets the kwild server hostname.

## chain:
This section contains configuration specific to CometBFT based blockchain.

- `moniker`: This variable sets a custom human-readable name for the node.

### rpc
This subsection contains the configuration required to manage blockchain's RPC service.

- `listen_addr`: This variable sets the TCP or UNIX socket address for the RPC server to listen on. Default listening address is on `tcp://127.0.0.1:26657`

### consensus
This subsection describes the configuration to manage consensus.

- `timeout_propose`: This variable sets the time to wait for a proposal block before prevoting nil. Default timeout is 3s.

- `timeout_prevote`: This variable sets the time to wait after receiving +2/3 prevotes for "anything". Default timeout is 1s.

- `timeout_precommit`: This variable sets the time to wait after receiving +2/3 precommits for "anything". Default timeout is 1s.

- `timeout_commit`: This variable sets the time to wait after committing a block before starting on the new height. Default timeout is 1s.

### p2p
This subsection describes the configuration to manage the p2p service handling peer connectivity between the nodes in the blockchain network.

- `listen_addr`: This variable sets the address to listen for incoming connections. Default listening address is `tcp://0.0.0.0:26656`.

- `external_address`: This variable sets the address to advertise to peers for them to dial. If empty, it will use the same port as the listening address, and will introspect on the listener.

- `persistent_peers`: This variable sets the comma-separated list of nodes to connect to and maintain persistent connections. This is a required field for a new node to connect to the existing nodes in the Kwil network.

- `addr_book_strict`: Toggle for strict address routability rules.

- `max_num_inbound_peers`: This variable sets the Maximum number of inbound peers.

- `max_num_outbound_peers`: This variable sets the Maximum number of outbound peers to connect to, excluding persistent peers.

- `unconditional_peer_ids`: This variable sets the List of node IDs for which connections will be (re)established irrespective of the max connections.

- `allow_duplicate_ip`: This variable sets the Toggle to disable guard against peers connecting from the same ip address.

### mempool
This subsection describes the configuration to manage blockchain's transaction mempool.

- `size`: This variable sets the maximum number of transactions in the mempool.

- `max_txs_bytes`: This variable sets the limit on the total size of all transactions in the mempool.

- `cache_size`: This variable sets the size of the cache used to filter transactions seen earlier.

This is the structure in which these configs must appear in the config.toml file. Refer to the sample [config.toml](./configuration.mdx#sample-configtoml) file for reference.

## Config Override
All the configs in `config.toml` can be overwritten either using the environment variables or the command line flags.  

The order of precedence: `flags > env variables > config.toml > defaults`. 

These configs can be translated into env variables or flags using the below rules: 


:::note
``` title=config.toml
[section]
   field1 = val1
[section.subsection]
   field2 = val2
```
The flag and env variables for field1 & field2 are as follows:
```
All environment variables corresponding to the configs are prefixed by "KWILD_"
Env variable:
- KWILD_SECTION_FIELD1
- KWILD_SECTION_SUBSECTION_FIELD2

Flags:
- section.field1
- section.subsection.field2
```
:::

For example, to overwrite the log level config during the startup:
```bash title="Env variable"
KWILD_LOG_LEVEL=debug

kwild --root_dir "path/to/root/dir"
```

```bash title="Command line flag"
kwild --root_dir "path/to/root/dir" --log.level "debug"
```

```bash title="Both env and cmdline flags"
KWILD_LOG_LEVEL=debug

kwild --root_dir "path/to/root/dir" --log.level "info"
```
If both flags and env variables are set, flags take precedence over environment variables.

## Sample config.toml

```yaml
# This is a TOML config file.
# For more information, see https://github.com/toml-lang/toml

# NOTE: Any path below can be absolute (e.g. "/var/myapp/data") or
# relative to the home directory (e.g. "data")

# Root Directory Structure:
# RootDir/
#   |- config.toml    (app and chain configuration for running the kwild node)
#   |- private_key   (node's private key)
#   |- abci/
#   |   |- config/
#   |   |   |- genesis.json   (genesis file for the network)
#   |   |   |- addrbook.json  (peer routable addresses for the kwild node)
#   |   |- data/
#   |   |   |- blockchain db files/dir (blockstore.db, state.db, etc)
#   |   |- info/
#   |- application/wal
#   |- data
#   |   |- kwild.db/
#   |- signing/

# Required files: config.toml, private_key, and genesis files
# The rest of the files & directories are created on the node startup

#######################################################################
###                    Logging Config Options                       ###
#######################################################################
[log]
# Output level for logging, default is "info". Other options are "debug", "error", "warn", "trace"
level = "info"

# Output paths for the logger, can be stdout or a file path
output_paths = ["stdout"]

# Output format: 'plain' or 'json'
format = "json"

# Time format: "epochfloat" (default), "epochmilli", or "rfc3339milli"
time_format = "epochfloat"

#######################################################################
###                      App Config Options                         ###
#######################################################################

[app]
# Node's Private key
private_key_path = "private_key"

# TCP or UNIX socket address for the KWILD App's GRPC server to listen on
grpc_listen_addr = "localhost:50051"

# TCP or UNIX socket address for the KWILD App's HTTP server to listen on
http_listen_addr = "localhost:8080"

# List of Extension endpoints to be enabled ex: ["localhost:50052", "169.198.102.34:50053"]
extension_endpoints = []

# KWILD Sqlite database file path
sqlite_file_path = "data/kwild.db"

# The path to a file containing certificate that is used to enable TLS on the gRPC server.
# Might be either absolute path or path related to the kwild root directory.
# If the certificate is signed by a certificate authority,
# the certFile should be the concatenation of the server's certificate, any intermediates,
# and the CA's certificate.
# NOTE: both tls_cert_file and tls_key_file must be present for CometBFT to enable TLS.
# Otherwise, HTTP server is run.
tls_cert_file = ""

# The path to a file containing matching private key that is used to enable TLS on the gRPC server.
# Might be either absolute path or path related to the kwild root directory.
# NOTE: both tls_cert_file and tls_key_file must be present for CometBFT to enable TLS.
# Otherwise, HTTP server is run.
tls_key_file = ""

# Kwild Server hostname
hostname = ""

#######################################################################
###                 Chain  Main Base Config Options                 ###
#######################################################################
[chain]

# A custom human readable name for this node
moniker = ""

#######################################################################
###                 Advanced Configuration Options                  ###
#######################################################################

#######################################################
###       RPC Server Configuration Options          ###
#######################################################
[chain.rpc]

# TCP or UNIX socket address for the RPC server to listen on
listen_addr = "tcp://127.0.0.1:26657"

#######################################################
###         Consensus Configuration Options         ###
#######################################################
[chain.consensus]

# How long we wait for a proposal block before prevoting nil
timeout_propose = "3s"

# How long we wait after receiving +2/3 prevotes for “anything” (ie. not a single block or nil)
timeout_prevote = "1s"

# How long we wait after receiving +2/3 precommits for “anything” (ie. not a single block or nil)
timeout_precommit = "1s"

# How long we wait after committing a block, before starting on the new
# height (this gives us a chance to receive some more precommits, even
# though we already have +2/3).
timeout_commit = "1s"

#######################################################
###           P2P Configuration Options             ###
#######################################################
[chain.p2p]

# Address to listen for incoming connections
listen_addr = "tcp://0.0.0.0:26656"

# Address to advertise to peers for them to dial
# If empty, will use the same port as the laddr,
# and will introspect on the listener or use UPnP
# to figure out the address. ip and port are required
# example: 159.89.10.97:26656
external_address = ""

# Comma separated list of nodes to keep persistent connections to (used for bootstrapping)
# Example: "d128266b8b9f64c313de466cf29e0a6182dba54d@172.10.100.2:26656,9440f4a8059cf7ff31454973c4f9c68de65fe526@172.10.100.3:26656"
persistent_peers = ""

# Set true for strict address routability rules
# Set false for private or local networks
addr_book_strict = false

# Maximum number of inbound peers
max_num_inbound_peers = 40

# Maximum number of outbound peers to connect to, excluding persistent peers
max_num_outbound_peers = 10

# List of node IDs, to which a connection will be (re)established ignoring any existing limits
unconditional_peer_ids = ""

# Toggle to disable guard against peers connecting from the same ip.
allow_duplicate_ip = true

#######################################################
###          Mempool Configuration Options          ###
#######################################################
[chain.mempool]
# Maximum number of transactions in the mempool
size = 5000

# Limit the total size of all txs in the mempool.
# This only accounts for raw transactions (e.g. given 1MB transactions and
# max_txs_bytes=5MB, mempool will only accept 5 transactions).
#max_txs_bytes = xx .ChainCfg.Mempool.MaxTxsBytes xx

# Size of the cache (used to filter transactions we saw earlier) in transactions
cache_size = 10000
```