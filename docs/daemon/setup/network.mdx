---
sidebar_position: 2
sidebar_label: "Network "
id: daemon-network-setup
title: Network Setup
description: Running a Kwil Network
slug: /daemon/network/setup
---

This guide provides step-by-step instructions for configuring and deploying a Kwil network with an initial set of M validator and N non-validator nodes. 

## Network Configuration
`kwil-admin setup` subcommand can be used to generate the configuration required for the M validator + N non-validator nodes.

For example, the configuration required to deploy a network with N=2 validator nodes and M=1 non-validator nodes can be generated as below.

If the IP addresses of these nodes are consecutive, you can specify the IP addresses using the starting-ip-address flag as follows:

```bash
kwil-admin setup testnet -v 2 -n 1 -o "path/to/output/dir" --starting-ip '192.168.10.10'
```

If the IP addresses are not consecutive, provide explicit ip addresses using --hostname as shown below.
```bash
kwil-admin setup testnet -v 2 -n 1 -o "path/to/output/dir" --hostname '192.168.10.10' --hostname '192.168.10.20' --hostname '192.168.10.30'
```

This command populates `persistent_peers` in `config.toml` based on the IP addresses configured using `starting_ip_address` or `hostname`. This is essential for discovering and establishing connections with other nodes within the network.

```bash title="Example"
# Generate configuration required for a testnet corresponding to 2 validator nodes and 1 non-validator nodes with IP addresses starting from '192.168.10.10' at location ~/.kwild

$ kwil-admin setup testnet -v 2 -n 1 -o "~/.kwild" --starting-ip '192.168.10.10'
Successfully initialized 3 node directories: ~/.kwild

# Running the above command generates 3 directories node0, node1, node2 under ~/.kwild. 
# Each node directory includes corresponding genesis.json, config.toml, private_key configuration files as shown below

$ ls ~/.kwild                                                               
node0   node1   node2

$ tree ~/.kwild/node0
~/.kwild/node0
├── abci
│   ├── config
│   │   └── genesis.json
│   └── data
├── config.toml
└── private_key

4 directories, 3 files

# The persistent_peers config in the config.toml is populated based on the IP addresses configured using either the `--hostname`  or the `--starting-ip-address` flag 
$ cat ~/.kwild/node0/config.toml| grep persistent_peers
persistent_peers = "fab8e5110fc5fd31ee02893fd204c72bde98ca1f@192.168.10.10:0,af3f6e68c844c3ffec2a78226934a0ad25a3cfea@192.168.10.11:0,753957364371f8c92146afd10853b4c0d3dec56b@192.168.10.12:0"

# Each of the node's Genesis file's initial validator list would include information corresponding to both the validator nodes.
$ cat ~/.kwild/node0/abci/config/genesis.json | jq '.validators'
[
  {
    "address": "FAB8E5110FC5FD31EE02893FD204C72BDE98CA1F",
    "pub_key": {
      "type": "tendermint/PubKeyEd25519",
      "value": "zELrwxQTSt3U5WU3z9sSGBdhXqeyioR9F5M+Zlh2Uyc="
    },
    "power": "1",
    "name": "validator-0"
  },
  {
    "address": "AF3F6E68C844C3FFEC2A78226934A0AD25A3CFEA",
    "pub_key": {
      "type": "tendermint/PubKeyEd25519",
      "value": "HR9zoOYqcYLoMiMcF6YPi8a2OObPAITPcczlvxV6kg4="
    },
    "power": "1",
    "name": "validator-1"
  }
]
```

## Deploying the Kwil network

1. Generate the configuration locally for N + M nodes as shown [above](./network.mdx#network-configuration)
2. Copy these node directories to the corresponding nodes
3. Run the below command on each node to start the Kwil node
    ```bash
    kwild --root_dir "path/to/node/root/dir"
    ```
